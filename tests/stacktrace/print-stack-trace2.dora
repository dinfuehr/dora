//= vm-args "--gc-verify"

// CHECK: b (tests/stacktrace/print-stack-trace2.dora:22:10)
// CHECK-NEXT: a (tests/stacktrace/print-stack-trace2.dora:18:10)
// CHECK-NEXT: main (tests/stacktrace/print-stack-trace2.dora:8:11)

fn main() {
  let e = a();

  // This should test if backtrace in Exception is created the right way
  // by retrieveStackTrace (as Array[Int32]).
  std::forceCollect();

  e.print();
}

fn a(): std::Stacktrace {
  return b();
}

fn b(): std::Stacktrace {
  return std::Stacktrace::new();
}
